jenkins:
  mode: NORMAL
  numExecutors: 2  # Enable controller executors for post-build tasks
  remotingSecurity:
    enabled: false

  securityRealm:
    local:
      allowsSignup: false
      users:
        - id: "camelbot"
          password: "${readFile:/run/secrets/jenkins_admin_password}"
        - id: "frank"
          password: "agentpass"

  authorizationStrategy:
    globalMatrix:
      permissions:
        - "Overall/Administer:camelbot"
        - "Overall/Read:frank"
        - "Agent/Connect:frank"
        - "Agent/Disconnect:frank" 
        - "Agent/Build:frank"
        - "Job/Build:frank"
        - "Job/Read:frank"

  # Keep permanent agents for traditional builds
  nodes:
    - permanent:
        name: "agent1"
        remoteFS: "/home/jenkins/agent"
        launcher:
          inbound:
            webSocket: true
            workDirSettings:
              disabled: false
              failIfWorkDirIsMissing: false
              internalDir: "remoting"
    - permanent:
        name: "agent2"
        remoteFS: "/home/jenkins/agent"
        launcher:
          inbound:
            webSocket: true
            workDirSettings:
              disabled: false
              failIfWorkDirIsMissing: false
              internalDir: "remoting"
